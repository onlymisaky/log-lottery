import{u as e,g as a}from"./chunk-zwcfaLD_.js";import{a as s}from"./chunk-Czrwg_dh.js";import{d as t,u as l,s as n,r,l as i,h as o,w as u,o as c,a as m,b as d,t as v,j as p,q as g,F as f,B as h,k as b}from"./chunk-BJkgHwmU.js";const k={class:"toast toast-top toast-end"},y={key:0,class:"alert alert-error"},w={key:1,class:"alert alert-success"},I={key:2,class:"alert alert-error"},x={class:""},C={for:"explore"},S=["accept"],j={class:"btn btn-primary btn-sm"},q={class:"p-0"},F={class:"flex items-center gap-8"},T={class:"avatar h-14"},$={class:"w-12 h-12 mask mask-squircle hover:w-14 hover:h-14"},_={class:"w-64"},B={class:"overflow-hidden font-bold whitespace-nowrap text-ellipsis"},D=["onClick"],L=t({__name:"ImageConfig",setup(t){const{t:L}=l(),N=e().globalConfig,{getImageList:U}=n(N),z=r("image/*"),A=r(0),E=i.createInstance({name:"imgStore"});async function G(e){if(!/image*/.test(e.target.files[0].type))return void(A.value=3);const{dataUrl:a,fileName:t}=await s(e.target.files[0]);E.setItem(`${(new Date).getTime().toString()}+${t}`,a).then((()=>{A.value=1,async function(){(await E.keys()).length>0&&E.iterate(((e,a)=>{N.addImage({id:a,name:a,url:"Storage"})}))}()})).catch((()=>{A.value=2}))}return o((()=>{})),u((()=>A.value),(e=>{0!==e&&setTimeout((()=>{A.value=0}),2e3)})),(e,s)=>(c(),m(f,null,[d("div",k,[2===A.value?(c(),m("div",y,[d("span",null,v(p(L)("error.uploadFail")),1)])):g("",!0),1===A.value?(c(),m("div",w,[d("span",null,v(p(L)("error.uploadSuccess")),1)])):g("",!0),3===A.value?(c(),m("div",I,[d("span",null,v(p(L)("error.notImage")),1)])):g("",!0)]),d("div",null,[d("div",x,[d("label",C,[d("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:z.value,onChange:G},null,40,S),d("span",j,v(p(L)("button.upload")),1)])]),d("ul",q,[(c(!0),m(f,null,h(p(U),(e=>(c(),m("li",{key:e.id,class:"mb-3"},[d("div",F,[d("div",T,[d("div",$,[b(a,{"img-item":e},null,8,["img-item"])])]),d("div",_,[d("div",B,v(e.name),1)]),d("div",null,[d("button",{class:"btn btn-error btn-xs",onClick:a=>function(e){"Storage"===e.url&&E.removeItem(e.id).then((()=>{N.removeImage(e.id)})),N.removeImage(e.id)}(e)},v(p(L)("button.delete")),9,D)])])])))),128))])])],64))}});export{L as default};
