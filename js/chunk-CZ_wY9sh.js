import{_ as a}from"./chunk-CcHIJ1YQ.js";import{u as l,i as t,b as e}from"./chunk-zwcfaLD_.js";import{r as o}from"./chunk-Czrwg_dh.js";import{d as n,u as s,s as i,r as d,h as r,o as p,a as b,b as c,t as m,j as u,k as g,F as f,a6 as y,a7 as h,a8 as x}from"./chunk-BJkgHwmU.js";const k={class:"modal-box"},_={class:"text-lg font-bold"},v={class:"py-4"},A={class:"modal-action"},N={method:"dialog",class:"flex gap-3"},T={class:"modal-box"},w={class:"text-lg font-bold"},C={class:"py-4"},P={class:"modal-action"},j={method:"dialog",class:"flex gap-3"},z={class:"min-w-1000px"},D={class:"flex gap-3"},W=["data-tip"],S=["download","href"],J={class:""},O={for:"explore"},L=["data-tip"],M={class:"btn btn-primary btn-sm"},R=n({__name:"PersonAll",setup(n){const{t:R}=s(),E=l().personConfig,{getAllPersonList:F,getAlreadyPersonList:I}=i(E),V=d(),$=d();async function q(a){const l=await o(a.target.files[0]),t=y(l,{type:"binary",cellDates:!0}),n=t.Sheets[t.SheetNames[0]],s=h.sheet_to_json(n),i=e(s);E.resetPerson(),E.addNotPersonList(i)}function B(){let a=JSON.parse(JSON.stringify(F.value));for(let e=0;e<a.length;e++)delete a[e].x,delete a[e].y,delete a[e].id,delete a[e].createTime,delete a[e].updateTime,delete a[e].prizeId,a[e].isWin?a[e].isWin=t.global.t("data.yes"):a[e].isWin=t.global.t("data.no"),a[e].prizeTime=a[e].prizeTime.join(","),a[e].prizeName=a[e].prizeName.join(",");let l=JSON.stringify(a);if(l=l.replaceAll(/uid/g,t.global.t("data.number")).replaceAll(/isWin/g,t.global.t("data.isWin")).replaceAll(/department/g,t.global.t("data.department")).replaceAll(/name/g,t.global.t("data.name")).replaceAll(/identity/g,t.global.t("data.identity")).replaceAll(/prizeName/g,t.global.t("data.prizeName")).replaceAll(/prizeTime/g,t.global.t("data.prizeTime")),a=JSON.parse(l),a.length>0){const l=h.json_to_sheet(a),t=h.book_new();h.book_append_sheet(t,l,"Sheet1"),x(t,"data.xlsx")}}function G(){E.resetAlreadyPerson()}function H(){E.deleteAllPerson()}const K=[{label:t.global.t("data.number"),props:"uid"},{label:t.global.t("data.name"),props:"name"},{label:t.global.t("data.department"),props:"department"},{label:t.global.t("data.identity"),props:"identity"},{label:t.global.t("data.isWin"),props:"isWin",formatValue:a=>a.isWin?t.global.t("data.yes"):t.global.t("data.no")},{label:t.global.t("data.operation"),actions:[{label:t.global.t("data.delete"),type:"btn-error",onClick:a=>{!function(a){E.deletePerson(a)}(a)}}]}];return r((()=>{})),(l,t)=>(p(),b(f,null,[c("dialog",{id:"my_modal_1",ref_key:"resetDataDialog",ref:V,class:"border-none modal"},[c("div",k,[c("h3",_,m(u(R)("dialog.titleTip")),1),c("p",v,m(u(R)("dialog.dialogResetWinner")),1),c("div",A,[c("form",N,[c("button",{class:"btn",onClick:t[0]||(t[0]=a=>V.value.close())},m(u(R)("button.cancel")),1),c("button",{class:"btn",onClick:G},m(u(R)("button.confirm")),1)])])])],512),c("dialog",{id:"my_modal_1",ref_key:"delAllDataDialog",ref:$,class:"border-none modal"},[c("div",T,[c("h3",w,m(u(R)("dialog.titleTip")),1),c("p",C,m(u(R)("dialog.dialogDelAllPerson")),1),c("div",P,[c("form",j,[c("button",{class:"btn",onClick:t[1]||(t[1]=a=>$.value.close())},m(u(R)("button.cancel")),1),c("button",{class:"btn",onClick:H},m(u(R)("button.confirm")),1)])])])],512),c("div",z,[c("h2",null,m(u(R)("viewTitle.personManagement")),1),c("div",D,[c("button",{class:"btn btn-error btn-sm",onClick:t[2]||(t[2]=a=>$.value.showModal())},m(u(R)("button.allDelete")),1),c("div",{class:"tooltip tooltip-bottom","data-tip":u(R)("tooltip.downloadTemplateTip")},[c("a",{class:"no-underline btn btn-secondary btn-sm",download:u(R)("data.xlsxName"),target:"_blank",href:`/log-lottery/${u(R)("data.xlsxName")}`},m(u(R)("button.downloadTemplate")),9,S)],8,W),c("div",J,[c("label",O,[c("div",{class:"tooltip tooltip-bottom","data-tip":u(R)("tooltip.uploadExcelTip")},[c("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:".xlsx,.xls",onChange:q},null,32),c("span",M,m(u(R)("button.importData")),1)],8,L)])]),c("button",{class:"btn btn-error btn-sm",onClick:t[3]||(t[3]=a=>V.value.showModal())},m(u(R)("button.resetData")),1),c("button",{class:"btn btn-accent btn-sm",onClick:B},m(u(R)("button.exportResult")),1),c("div",null,[c("span",null,m(u(R)("table.luckyPeopleNumber"))+":",1),c("span",null,m(u(I).length),1),t[4]||(t[4]=c("span",null," / ",-1)),c("span",null,m(u(F).length),1)])]),g(a,{"table-columns":K,data:u(F)},null,8,["data"])])],64))}});export{R as default};
